{% extends "base.html" %}

{% block title %}æ‰“å¡æäº¤{% endblock %}

{% block main_class %}checkin-form{% endblock %}

{% block content %}
<form id="checkinForm">
    <!-- èœœç½å­—æ®µï¼šæ­£å¸¸ç”¨æˆ·çœ‹ä¸åˆ°ï¼Œæœºå™¨äººä¼šå¡«å†™ -->
    <div style="position: absolute; left: -9999px; opacity: 0; height: 0; overflow: hidden;">
        <label for="website">Website (è¯·å‹¿å¡«å†™)</label>
        <input type="text" id="website" name="website" tabindex="-1" autocomplete="off">
    </div>
    <!-- è¡¨å•åŠ è½½æ—¶é—´æˆ³ -->
    <input type="hidden" id="form_token" name="form_token" value="">
    
    <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
    <div class="user-info-section">
        <div class="user-info-row">
            <!-- å¤´åƒé€‰æ‹©å™¨ï¼ˆTelegramé£æ ¼ï¼‰ -->
            <div class="avatar-picker">
                <div class="avatar-trigger" id="avatarTrigger">ğŸ¥°</div>
                <div class="emoji-dropdown" id="emojiDropdown">
                    <div class="emoji-grid" id="emojiGrid">
                        <button type="button" class="emoji-btn" data-emoji="ğŸ¥°">ğŸ¥°</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ¥µ">ğŸ¥µ</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ¥º">ğŸ¥º</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ¤¤">ğŸ¤¤</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ˜»">ğŸ˜»</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ’¦">ğŸ’¦</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ‘…">ğŸ‘…</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ†">ğŸ†</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ’‹">ğŸ’‹</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ˜ˆ">ğŸ˜ˆ</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ’•">ğŸ’•</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ’“">ğŸ’“</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ«¦">ğŸ«¦</button>
                        <button type="button" class="emoji-btn" data-emoji="ğŸ‘„">ğŸ‘„</button>
                    </div>
                </div>
                <input type="hidden" id="avatar" name="avatar" value="ğŸ¥°">
            </div>
            <!-- æ˜µç§°è¾“å…¥ -->
            <div class="nickname-input">
                <input type="text" id="nickname" name="nickname" placeholder="æ˜µç§°ï¼ˆé»˜è®¤ï¼šç”¨æˆ·0721ï¼‰" maxlength="20">
            </div>
        </div>
        <div class="user-info-row contacts-row">
            <input type="email" id="email" name="email" placeholder="ğŸ“§ é‚®ç®±ï¼ˆå¯é€‰ï¼‰">
            <input type="tel" id="qq" name="qq" placeholder="ğŸ’¬ QQï¼ˆå¯é€‰ï¼‰" pattern="[0-9]*" maxlength="11">
            <input type="url" id="url" name="url" placeholder="ğŸ”— ä¸»é¡µï¼ˆå¯é€‰ï¼‰">
        </div>
    </div>

    <!-- å†…å®¹åŒºåŸŸ -->
    <div class="form-group">
        <label for="content">ğŸ“ è¿™æ¬¡ç”¨çš„ä»€ä¹ˆ</label>
        <textarea 
            id="content" 
            name="content" 
            rows="6" 
            placeholder="è®°å½•ä¸€ä¸‹å§... æœ¬å­é“¾æ¥ã€æ„Ÿæƒ³ã€ç”¨çš„ä»€ä¹ˆç´ æ..."
            required
        ></textarea>
        <div class="char-count">
            <span id="charCount">0</span> å­—
        </div>
    </div>

    <div class="form-group">
        <label>ğŸ–¼ï¸ ä¸Šä¼ å›¾ç‰‡/è§†é¢‘/å‹ç¼©åŒ… (æœ€å¤§ 50MB)</label>
        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <p>ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</p>
            <p class="upload-hint">æ”¯æŒ: JPG, PNG, GIF, MP4, WEBM, ZIP, 7Z</p>
            <input 
                type="file" 
                id="fileInput" 
                name="files" 
                multiple 
                accept="image/*,video/*,.zip,.7z,application/zip,application/x-zip-compressed,application/x-7z-compressed"
                hidden
            >
        </div>
    </div>

    <div class="preview-container" id="previewContainer"></div>

    <div class="form-actions">
        <button type="button" class="btn btn-secondary" id="resetBtn">
            ğŸ”„ æ¸…ç©º
        </button>
        <button type="submit" class="btn btn-primary btn-submit" id="submitBtn">
            <span class="btn-text">ğŸ’¦ è®°å½•è¿™ä¸€å‘</span>
            <span class="btn-icon">â†’</span>
        </button>
    </div>
</form>

<div class="message" id="message"></div>
{% endblock %}

{% block scripts %}
<script type="module" src="/static/js/pages/index/main.js"></script>
{% endblock %}
